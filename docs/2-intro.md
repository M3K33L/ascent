# 2 INTRODUCTION
Implanted pacemakers for the nervous system are an appealing alternative to pharmacotherapies because they continuously deliver a clinician-prescribed dose of electrical signals to produce targeted and reversible changes in nerve activity. Vagus nerve stimulation (VNS) is an FDA-approved therapy including a cuff electrode around the left cervical vagus nerve and leads to a pulse generator implanted subcutaneously in the chest. Stimulating the nerve with low frequencies, e.g., tens of hertz, activates the underlying nerve fibers to treat pharmacoresistant epilepsy (The Vagus Nerve Stimulation Study Group., 1995; Ben-Menachem et al., 1994; Handforth et al., 1998) and depression (Marangell et al., 2002; Nierenberg et al., 2008; Rush et al., 2000). 

The diverse end-organ targets of the vagus nerve—including the heart, stomach, intestines, lungs, and pancreas—make VNS a potential therapy to treat a wide range of diseases (Birmingham et al., 2014). VNS is under investigation for novel therapeutic applications such as sepsis, fibromyalgia, migraine, cardiovascular disease, ventilator-induced lung injury, stroke and traumatic brain injury, diabetes, and rheumatoid arthritis (Johnson & Wilson, 2018). For example, researchers and clinicians are successfully targeting the auricular branch for migraine (Stefan et al., 2012; Straube et al., 2015) and the subdiaphragmatic branches for obesity (Apovian et al., 2017; Ikramuddin et al., 2014). By stimulating the subdiaphragmatic branches at kilohertz frequencies, e.g., 5000 Hz, conduction of action potentials may be blocked (c.f., (Pelot et al., 2017)) to treat obesity.  

Despite promising preclinical data for novel applications of VNS, translating the effects of VNS from animal models has proven challenging. Physiological responses to electrical stimulation vary due to differences in intervention design (i.e., electrode cuff design and placement, and stimulation waveform) in addition to biophysical properties (i.e., nerve morphology and fiber types). Preclinical studies of VNS are performed in many different species: mice, rats, guinea pigs, ferrets, rabbits, cats, dogs, pigs, and sheep (Andrews & Scratcherd, 1980; Fernandez-Guardiola et al., 1999; Hoffmann et al., 2012; Huffman et al., 2019; Sears et al., 1999; Uitterdijk et al., 2015; Vanoli et al., 1991). Since different species and locations of stimulation involve different nerve diameters, cuff electrodes of different sizes are placed around the nerve for each application. However, the geometry of the cuff and the configuration of the active contacts have substantial impacts on the activation of nerve fibers for a given set of stimulation parameters. Therefore, accurately modeling the change in neural activity (i.e., activation or block of underlying fibers) in response to electrical stimulation requires that models represent application-specific neural anatomy (i.e., species and location of intervention), electrode cuffs, and stimulation parameters. See Box 1 for required metadata to accurately model in vivo nerve stimulation experiments. Unlike existing open source modeling pipelines for peripheral nerve stimulation, ASCENT automates the highly-parameterized and multistep process required to accurately simulate the response of biophysically realistic model fibers to electric fields that account for individual-specific neural anatomy, application specific electrodes, and custom waveforms (Lubba et al., 2019).

##### Box 1. Metadata required to model an in vivo experiment using the ASCENT pipeline.
<div style="border:1px solid black;">

1. Detailed dimensions of the stimulating cuff.
2. Transverse cross section of the nerve where the cuff is placed, stained to visualize the different tissue types (e.g., using Masson’s trichrome), with a scale bar. Different possible sources for the nerve sample include:
    - For best specificity, the nerve sample would be from dissection of the specific animal used in the experiment being modeled. In this case, tissue dyes may be used on the ventral and medial aspects to maintain orientation information.
    - Otherwise, a sample from another animal could be used at the correct nerve level.
    - If multiple samples from other animals are available, they could be used to generate a representative model, knowing the range of morphological metrics across individuals.
    - Lastly, published data could be used.
3. Rotation of the cuff on the nerve (e.g., cuff closure on the ventral side of the nerve).
4. Fiber diameters
    - Distributions of fiber diameters may be obtained from literature; otherwise, detailed electromicroscopic studies are required.
    - The fiber diameters found in the target nerve will be simulated in NEURON. All diameters or a subset of diameters may be of interest. 
    - Each fiber diameter of interest can be simulated for each fiber location of interest, or specific fiber diameters can be simulated in specific locations.
5. Approximate tissue or fluids surrounding the nerve and cuff (e.g., muscle, saline).
6. Stimulation waveforms, pulse widths, and other parameters.
7. If comparing to neural recordings: Distance between the stimulation and recording cuffs.
8. If comparing to functional recordings (e.g., EMG): Distance from the stimulation cuff to the nerve's muscle insertion.

</div>

Computational modeling methods to predict nerve response to stimulation and to design peripheral neural interfaces have taken various forms. Some researchers have performed macro-scale modeling with patient phantoms created from MRI to simulate non-invasive nerve stimulation, though their approaches lack micro-scale detail of individual-specific neural anatomy (Mourdoukoutas et al., 2018; Neufeld et al., 2016). In other studies, researchers have used realistic cuff-designs with generalized representations of nerve microanatomy and biophysically realistic fiber models (Bucksot et al., 2019; Pelot et al., 2017). Patient-specific models of peripheral nerve stimulation have been published, though a standardized platform for the research community to model their own samples has yet to be established (Helmers et al., 2012; Zelechowski et al., 2020)

We describe the implementation and application of a pipeline for computational modeling of peripheral nerve electrical stimulation. The ASCENT (Automated Simulations to Characterize Electrical Nerve Thresholds) pipeline provides tools to design experimental and therapeutic interventions, to interpret experimental results, and to act as a component of integrated simulations with other models (e.g., organ system models). The resulting models and stimulation thresholds can be used to address analysis and design goals that target critical gaps limiting the advancement of bioelectronic medicines, including quantification of the effects of within- and across-species differences on nerve activation and block, as well as approaches to increase the selectivity and efficiency of activation and block with novel stimulation paradigms and electrode cuffs.