/*
Author: Nikki Pelot
Date created: February 4, 2016

Description:
- Generalized procedure to save time courses to file

Important notes:
- 

Variables that must be defined in wrapper/params file:
None.
*/

// TESTING
/*
load_file("ObjectArray_1d.hoc")

dt 				= 0.001
tstop 			= 250
n_tsteps 		= int(tstop/dt) + 1			// int truncates twds zero; +1 accounts for the time point at t=0 [unitless]

strdef arg1, arg2, arg4
objref arg3, arg5

arg1 = "testfile.dat"

arg2 = "Vm"

arg3 = new Vector(3,0)
arg3.x[0] = 13
arg3.x[1] = 2
arg3.x[2] = 76

arg4 = "(mV)"

N = 23
arg5 = new O1d(N)
for i = 0, N-1 {
	arg5.o[i] = new Vector(n_tsteps, 0)
}
*/
// END TESTING

// There is no "localstr", so just define the strings here
strdef myfname, mycolprefix, mycolunits
objref output_file

proc SaveTimeCourse() {localobj mydata, mycolsuffix_vec
	myfname = $s1
	mycolprefix = $s2
	mycolsuffix_vec = $o3
	mycolunits = $s4
	mydata = $o5

	output_file = new File()
	output_file.wopen(myfname)

	// Column headers
	output_file.printf("Time(ms) ")
	for col_ind = 0, mycolsuffix_vec.size()-1 {
		output_file.printf("%s%d%s ", mycolprefix, mycolsuffix_vec.x[col_ind], mycolunits)
	}
	output_file.printf("\n")

	// Time stamp & associated data for each row
	for t_ind = 0, n_tsteps-1 {
		output_file.printf("%f ", t_ind*dt)
		for col_ind = 0, mycolsuffix_vec.size()-1 {
			output_file.printf("%f ", mydata.o[col_ind].x[t_ind])
		}
		output_file.printf("\n")
	}

	output_file.close()
}

// TESTING
/*
SaveTimeCourse(arg1, arg2, arg3, arg4, arg5)
*/
// END TESTING